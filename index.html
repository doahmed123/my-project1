<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene>
      <!-- النموذج ثلاثي الأبعاد -->
      <a-entity
        gltf-model="https://raw.githubusercontent.com/doahmed123/my-project1/main/the_great_pyramid_of_giza_egypt.glb"
        position="0 1 -3"
        scale="1 1 1"
        id="model"
      ></a-entity>

      <!-- علامة الدوران -->
      <a-circle
        position="0 0.5 -2.5"
        radius="0.5"
        color="#ff5722"
        rotation-handler
        id="rotation-control"
      ></a-circle>

      <!-- الإضاءة -->
      <a-light type="directional" intensity="1" position="1 3 1"></a-light>
      <a-light type="ambient" intensity="0.5"></a-light>
    </a-scene>

    <script>
      // مكون التعامل مع علامة الدوران
      AFRAME.registerComponent("rotation-handler", {
        init: function () {
          const model = document.querySelector("#model").object3D;
          this.isDragging = false; // لتعقب حالة السحب
          this.previousMousePosition = { x: 0, y: 0 }; // موقع الماوس السابق

          // عند الضغط على العلامة
          this.el.addEventListener("mousedown", (event) => {
            this.isDragging = true;
            this.previousMousePosition = { x: event.clientX, y: event.clientY };
          });

          // عند تحريك الماوس
          window.addEventListener("mousemove", (event) => {
            if (!this.isDragging) return;

            const deltaX = event.clientX - this.previousMousePosition.x;

            const rotationSpeed = 0.005; // سرعة الدوران

            // تحديث دوران النموذج بناءً على حركة الماوس
            model.rotation.y += deltaX * rotationSpeed;

            this.previousMousePosition = { x: event.clientX, y: event.clientY };
          });

          // عند إفلات زر الماوس
          window.addEventListener("mouseup", () => {
            this.isDragging = false;
          });
        },
      });
    </script>
  </body>
</html>
